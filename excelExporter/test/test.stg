//
// test.stg
// This is a template group file for StringTemplate V4, see www.stringtemplate.org.
//
// 
//
// Copyright (C) 2015 Peter Vranken (mailto:Peter_Vranken@Yahoo.de)
//
// This program is free software: you can redistribute it and/or modify it
// under the terms of the GNU Lesser General Public License as published by the
// Free Software Foundation, either version 3 of the License, or any later
// version.
//
// This program is distributed in the hope that it will be useful, but WITHOUT
// ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
// FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License
// for more details.
//
// You should have received a copy of the GNU Lesser General Public License
// along with this program. If not, see <http://www.gnu.org/licenses/>.

delimiters "<", ">"

test(cluster,info) ::= <<
Cluster <cluster.name_> contains <cluster.noBooks> workbooks:
  <cluster.bookAry:{workbook|<renderWorkbook(workbook,info)>}>

Updated at: <info.time>
>>

renderWorkbook(workbook,info) ::= <<
<workbook> (<workbook.excelFile>)
  <workbook.sheetAry:renderWorksheet()>
>>

renderWorksheet(sheet) ::= <<
This is worksheet <sheet.name_>
Sheet.name_: <sheet.name_>
<renderContainer(sheet)>
>>

renderContainer(C) ::= <<
<C:{grN|group <i>: <grN> }>
Container: <C.name_>=<C.rowAry.parent>
<C.rowAry:{row|Row <row.iRow>:<\n><renderRowObject(row)>}>
<C.groupAry:renderContainer()>
>>

renderRowObject(row) ::= <<
<row.cellAry:{cell|Property <cell.i>: <cell.name_>=<renderCell(cell)><\n>}>
>>

renderCell(cell) ::= <<
<if(cell.isDate || cell.isText || cell.isError)><cell.text><\\>
<elseif(cell.isInt)><cell.d; format="$%x"><\\>
<elseif(cell.isReal)><cell.n; format="%.3f"><\\>
<elseif(cell.isBool)><cell.bool><\\>
<elseif(!cell.isNotBlank)>(blank)<\\>
<endif><\\>
<!<if(cell.isNotBlank)> (not blank)<endif>!>, pos: (<cell.iRow>,<cell.iCol>), type: <cell.type>
>>